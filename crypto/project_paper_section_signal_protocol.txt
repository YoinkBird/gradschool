Signal incorporates a server with the double ratchet protocol.
The two parties then communciate directly with the server instead of having to wait for each other to be online.
Without the Server, both parties woudl have to be online at the same time in order to carry out key exchanges and to send or receive messages.
Each client implementing the protocol would have to queue up messages waiting to be sent until the other party is available, which means that the users would essentially have to schedule times to be online at the same time.
Using a server resolves this problem, each party sends their keys and messages to the server which then relays them to the other party.

This ensures that the key gets updated any time either party is online, even if they don't send a message.
The remaining risk is that the keys become stale if one party is never online and never sends a new key to the server.
However, the practical implication of this scenario is that e.g. Bob has neither read nor responded to Alice's messages, at which point Alice needs to use other means to determine why Bob is non engaging.
This particular scenario cannot be easily resolved via any protocol and is a reminder that shared-key cryptography is only effective if both parties cooperate.

To illustrate this, assume two people Alice (A) and Bob (B) wish to communicate securely.
Registration
* A and B both register with the Server (S), at which point they submit an initial ephemeral key, KA0 and KB0 respectively.
Key Exchange
* A requests and receives B's key (KB) from S
* A generates a new ephemeral key KA1 and registers it with S
A can now immediately compute a new shared key KA1B0 and start sending messages encrypted with a new Double Ratchet
Note that B does not have to be online.
* B now comes online and performs similar actions
* B receives the new KA1 and immediately calculates the equivalent shared key KA1B0
This enables Bob to decrypt any messages received while offline
* B generates a new ephemeral key KB1 and registers it with S
B can now immediately compute a new shared key KA1B1 and start sending messages encrypted with a new Double Ratchet
Note that A does not have to be online.
Message Exchange
* A encrypts her messages with the Message Keys generated by the Double Ratchet


